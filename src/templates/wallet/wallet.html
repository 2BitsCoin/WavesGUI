<div id="mBB-wallet" class="mBB-content" ng-controller="walletListController as walletList">

    <div class="noDisp" ng-controller="walletSendController as send">
        <div id="wB-butSend-WAV" waves-dialog ok-button-caption="SUBMIT" cancel-button-visible="false"
             on-dialog-ok="send.submitTransfer(send.form)">
            <form id="send-waves-form" name="send.form" class="paymentForm" novalidate
                  ng-validate="send.validationOptions">
                <h2 class="sectionHeader">SEND PAYMENT: {{send.currency}}</h2>
                <table>
                    <div class="balanceAmt">
                        <div ng-if="!send.feeAndTransferAssetsAreTheSame"><p>Asset balance: </p><span
                                class="balancewaves">{{send.assetBalance | moneyLong:true}}</span><br/>
                        </div>
                        <p>Waves balance: </p><span class="balancewaves">{{send.feeAssetBalance | moneyLong:true}}</span>
                    </div>
                    <thead>
                    <tr>
                        <th>DESCRIPTION</th>
                        <th>INPUT</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>Recipient's Address</td>
                        <td>
                            <div class="form-field">
                                <input class="wInput form-control" name="sendRecipient" type="text"
                                       placeholder="Recipient" ng-model="send.recipient"/>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Amount</td>
                        <td>
                            <div class="form-field">
                                <input class="wInput form-control" name="sendAmount" type="text"
                                       placeholder="Amount" ng-model="send.amount"
                                       decimal-input-restrictor/>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Attachment</td>
                        <td>
                            <div class="form-field">
                                                <textarea rows="2" class="wInput form-control" name="sendAttachment"
                                                          ng-model="send.attachment"></textarea>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Fee</td>
                        <td>
                            <md-autocomplete md-input-name="sendFee"
                                             md-selected-item="send.autocomplete.selectedFee"
                                             md-search-text="send.autocomplete.searchText"
                                             md-items="item in send.autocomplete.querySearch(send.autocomplete.searchText)"
                                             md-item-text="item.amount.toString()" md-min-length="0"
                                             md-require-match="" md-no-cache="true"
                                             md-menu-class="popup-autocomplete"
                                             class="fee-autocomplete">
                                <md-item-template>
                                    <span md-highlight-text="send.autocomplete.searchText">{{item.displayText}}</span>
                                </md-item-template>
                            </md-autocomplete>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </form>
        </div>
        <div id="send-payment-confirmation" waves-dialog ok-button-caption="CONFIRM"
             ok-button-enabled="!send.broadcast.pending" on-dialog-ok="send.broadcastTransaction()">
            <div class="dialog-confirmation">
                <p class="dialog-text">You are sending <span class="confirmation-value">{{send.confirm.amount | moneyLong:true}}</span>
                    with
                    <span class="confirmation-value">{{send.confirm.fee | moneyLong:true}}</span> fee to
                    the address<br/>
                    <span class="confirmation-value">{{send.confirm.recipient}}</span>
                </p>
                <p class="dialog-text">Please <span class="fontBold"> CONFIRM </span>to execute or <span
                        class="fontBold"> CANCEL </span> to discard.</p>
            </div>
        </div>
    </div>

    <div class="noDisp" ng-controller="walletWithdrawController as withdraw">
        <div id="withdraw-btc-dialog" waves-dialog ok-button-caption="WITHDRAW"
             on-dialog-ok="withdraw.confirmWithdraw(withdraw.assetForm)">
            <h2 class="sectionHeader">WITHDRAW: {{withdraw.sourceCurrency}}</h2>
            <form id="withdraw-asset-form" name="withdraw.assetForm" novalidate
                  ng-validate="withdraw.validationOptions">
                <table class="form-table">
                    <div class="balanceAmt">
                        <div><p>Asset balance: </p><span class="balancewaves">{{withdraw.assetBalance | moneyLong:true}}</span><br/>
                        </div>
                    </div>
                    <tbody>
                    <tr>
                        <td width="30%">Bitcoin Address</td>
                        <td><input class="wInput form-control" name="withdrawAddress" type="text"
                                   placeholder="Bitcoin address" ng-model="withdraw.recipient"/></td>
                    </tr>
                    <tr>
                        <td>Amount</td>
                        <td><input class="wInput form-control" name="withdrawAmount" type="text"
                                   placeholder="Withdraw amount" ng-model="withdraw.amount"
                                   ng-change="withdraw.refreshTotal()" decimal-input-restrictor/></td>
                    </tr>
                    <tr>
                        <td>Gateway fee</td>
                        <td><input disabled class="wInput form-control" name="gatewayFee" type="text"
                                   placeholder="Gateway fee" ng-model="withdraw.feeOut"
                                   decimal-input-restrictor/></td>
                    </tr>
                    <tr>
                        <td>Total</td>
                        <td><input class="wInput form-control" name="withdrawTotal" type="text"
                                   placeholder="Total amount" ng-model="withdraw.total"
                                   ng-change="withdraw.refreshAmount()" decimal-input-restrictor/></td>
                    </tr>
                    <tr>
                        <td class="padded">Waves fee</td>
                        <td class="padded">
                            <md-autocomplete md-input-name="withdrawFee"
                                             md-selected-item="withdraw.autocomplete.selectedFee"
                                             md-search-text="withdraw.autocomplete.searchText"
                                             md-items="item in withdraw.autocomplete.querySearch(withdraw.autocomplete.searchText)"
                                             md-item-text="item.amount.toString()" md-min-length="0"
                                             md-require-match="" md-no-cache="true"
                                             md-menu-class="popup-autocomplete"
                                             class="fee-autocomplete">
                                <md-item-template>
                                    <span md-highlight-text="withdraw.autocomplete.searchText">{{item.displayText}}</span>
                                </md-item-template>
                            </md-autocomplete>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </form>
        </div>
        <div id="withdraw-confirmation" waves-dialog ok-button-caption="CONFIRM"
             ok-button-enabled="!withdraw.broadcast.pending"
             on-dialog-ok="withdraw.broadcastTransaction()">
            <div class="dialog-confirmation">
                <p class="dialog-text">You are sending <span class="confirmation-value">{{withdraw.confirm.amount | moneyLong:true}}</span>
                    with
                    <span class="confirmation-value">{{withdraw.confirm.fee | moneyLong:true}}</span>
                    fee to the Waves gateway address <br/>
                    <span class="confirmation-value">{{withdraw.confirm.gatewayAddress}}</span>.
                </p>
                <p class="dialog-text">The gateway will transfer these funds to your bitcoin address:
                    <span class="confirmation-value">{{withdraw.confirm.recipient}}</span>.</p>
                <p class="dialog-text">Press <span class="fontBold"> CONFIRM </span>to execute or <span
                        class="fontBold"> CANCEL </span> to discard this operation.</p>
            </div>
        </div>
    </div>

    <div class="noDisp" ng-controller="walletWithdrawController as withdraw">
        <div id="withdraw-fiat-dialog" waves-dialog ok-button-caption="CLOSE"
             cancel-button-visible="false">
            <h2 class="sectionHeader">WITHDRAW: {{withdraw.sourceCurrency}}</h2>
            <p class="dialog-text textCenter">
                If you've been verified and deposited {{withdraw.sourceCurrency}}<br/>
                you can withdraw {{withdraw.sourceCurrency}} back to your bank account<br/>
                <br/>
                To do so please make a SEND transaction to the<br/>
                Waves address <span class="email"
                                    title="Copy this address to the clipboard"
                                    tooltipster
                                    tooltip-theme="tooltipster-theme1"
                                    ngclipboard
                                    data-clipboard-text="3P7qtv5Z7AMhwyvf5sM6nLuWWypyjVKb7Us"
                                    ngclipboard-success="clipboardOk()">3P7qtv5Z7AMhwyvf5sM6nLuWWypyjVKb7Us</span><br/>
                <br/>
                Fees are 1% from the amount transferred<br/>
                <br/>
                The minimum amount is 100 {{withdraw.sourceCurrency}}<br/>
                <br/>
                Bank transfer can take up to 3 working days
            </p>
            <br/>
            <p class="dialog-text textCenter">
                If you have any questions,<br/>
                please just send an email to<br/>
                <span class="email"
                      title="Copy this address to the clipboard"
                      tooltipster
                      tooltip-theme="tooltipster-theme1"
                      ngclipboard
                      data-clipboard-text="{{withdraw.gatewayEmail}}"
                      ngclipboard-success="clipboardOk()">{{withdraw.gatewayEmail}}</span>
            </p>
        </div>
    </div>

    <div class="noDisp" ng-controller="walletDepositController as deposit">
        <div id="deposit-btc-dialog" waves-dialog ok-button-caption="CLOSE"
             cancel-button-visible="false">
            <h2 class="sectionHeader">DEPOSIT: BTC</h2>
            <p class="dialog-text textCenter">
                <img src="img/visa-mastercard-116x35.gif" width="116" height="35"><span
                    class="divider-2"></span>
                <button class="wButton wButton-dialog"
                        ng-click="walletList.depositFromCard(deposit.assetBalance.currency)">
                    Buy BTC from your credit card
                </button>
            </p>
            <p class="dialog-text">To deposit {{deposit.currency}} to your Waves account, please send
                BTC to the address below.<br/>
                The minimum amount for deposit is <span class="fontBold">{{::deposit.btc.minimumAmount}} BTC</span>.
            </p>
            <table class="wavesTable bitcoin-requisites">
                <tbody>
                <tr>
                    <td><b>{{deposit.btc.bitcoinAddress}}</b></td>
                </tr>
                </tbody>
            </table>
            <p class="dialog-text">Enter this address into your bitcoin client or wallet. Once the
                transaction is confirmed, <br/>
                the gateway will process the transfer of BTC to a token in your Waves account.</p>
            <p class="dialog-text">Please note that the gateway doesn't apply any fees for this
                operation.</p>
            <p class="dialog-text">You can scan this QR-code in order to copy the address.<br/>
                Amount is optional but it will be added to the QR-code if present.</p>
            <div class="textCenter">
                <input class="wInput small" type="text" placeholder="Amount"
                       ng-model="deposit.btc.bitcoinAmount" ng-change="deposit.refreshBTCUri()"
                       decimal-input-restrictor/>
                <br/>
                <br/>
                <a ng-href="{{deposit.btc.bitcoinUri}}">
                    <waves-qr-code class="center" size="180"
                                   value="deposit.btc.bitcoinUri"></waves-qr-code>
                </a>
            </div>
        </div>
    </div>

    <div class="noDisp" ng-controller="walletDepositController as deposit">
        <div id="deposit-eur-dialog" waves-dialog ok-button-caption="CLOSE"
             cancel-button-visible="false">
            <h2 class="sectionHeader">DEPOSIT: EUR</h2>
            <p class="dialog-text textCenter">VERIFICATION</p>
            <p class="dialog-text textCenter">
                In order to deposit Euros directly from your bank<br/>
                account through SEPA transfer you MUST get verified<br/>
                by our partner <a href="https://www.idnow.eu/" target="_blank">IDNow.eu</a>
            </p>
            <p class="dialog-text textCenter">
                <a href="https://wavesplatform.userecho.com/topics/1303-buying-eurotoken-with-sepa-transfer/"
                   target="_blank">Read more about SEPA transfers</a>
            </p>
            <p class="dialog-text textCenter">
                <a href="https://wavesplatform.userecho.com/topics/1304-list-of-accepted-countries-and-documents-for-verification/"
                   target="_blank">List of eligible countries and IDs</a>
            </p>
            <p class="dialog-text textCenter">
                In order to get verified follow the link:<br/>
                <a href="{{deposit.fiat.verificationLink}}" target="_blank">{{deposit.fiat.verificationLink}}</a>
            </p>
            <p class="dialog-text textCenter">We don't accept international wire transfers from US
                Citizens or from USA Banks</p>
            <br/>
            <p class="dialog-text textCenter">
                In case the link doesn't work for you,<br/>
                please just send an email to<br/>
                <span class="email"
                      title="Copy this address to the clipboard"
                      tooltipster
                      tooltip-theme="tooltipster-theme1"
                      ngclipboard
                      data-clipboard-text="{{deposit.fiat.email}}"
                      ngclipboard-success="clipboardOk()">{{deposit.fiat.email}}</span>
                <br/>
                with your Waves wallet address as the subject
            </p>
        </div>
    </div>

    <div class="noDisp" ng-controller="walletDepositController as deposit">
        <div id="deposit-usd-dialog" waves-dialog ok-button-caption="CLOSE"
             cancel-button-visible="false">
            <h2 class="sectionHeader">DEPOSIT: USD</h2>
            <p class="dialog-text textCenter">VERIFICATION</p>
            <p class="dialog-text textCenter">
                In order to deposit USD directly from your bank<br/>
                account through wire transfer you MUST get verified<br/>
                by our partner <a href="https://www.idnow.eu/" target="_blank">IDNow.eu</a>
            </p>
            <p class="dialog-text textCenter">
                <a href="https://wavesplatform.userecho.com/topics/1304-list-of-accepted-countries-and-documents-for-verification/"
                   target="_blank">List of eligible countries and IDs</a>
            </p>
            <p class="dialog-text textCenter">
                In order to get verified follow the link:<br/>
                <a href="{{deposit.fiat.verificationLink}}" target="_blank">{{deposit.fiat.verificationLink}}</a>
            </p>
            <p class="dialog-text textCenter">We don't accept international wire transfers from US
                Citizens or from USA Banks</p>
            <br/>
            <p class="dialog-text textCenter">
                In case the link doesn't work for you,<br/>
                please just send an email to<br/>
                <span class="email"
                      title="Copy this address to the clipboard"
                      tooltipster
                      tooltip-theme="tooltipster-theme1"
                      ngclipboard
                      data-clipboard-text="{{deposit.fiat.email}}"
                      ngclipboard-success="clipboardOk()">{{deposit.fiat.email}}</span>
                <br/>
                with your Waves wallet address as the subject
            </p>
        </div>
    </div>

    <div class="noDisp" ng-controller="cardDepositController as card">
        <div id="card-deposit-dialog" waves-dialog ok-button-caption="BUY"
             on-dialog-ok="card.redirectToMerchant(card.form)">
            <h2 class="sectionHeader">DEPOSIT FROM CARD: <b>{{card.crypto.shortName}}</b></h2>
            <p class="textCenter">Please note: the minimum amount you can pay is <b>{{card.limits.min |
                number:0}} {{card.payCurrency.displayName}}</b>,<br/>
                the maximum is <b>{{card.limits.max | number:0}} {{card.payCurrency.displayName}}</b>
            </p>
            <form id="depositCalculatorForm" name="card.form" novalidate>
                <div layout="row">
                    <md-input-container>
                        <label>Amount you pay</label>
                        <input name="payAmount" ng-model="card.payAmount" type="text"
                               ng-change="card.updateReceiveAmount()"
                               ng-model-options="{ debounce: 250 }" decimal-input-restrictor/>
                    </md-input-container>
                    <md-input-container>
                        <label>Currency</label>
                        <md-select ng-model="card.payCurrency"
                                   ng-change="card.updateLimitsAndReceiveAmount()" width="2">
                            <md-optgroup label="Your card currency">
                                <md-option ng-value="currency" ng-repeat="currency in card.currencies">
                                    {{currency.displayName}}
                                </md-option>
                            </md-optgroup>
                        </md-select>
                    </md-input-container>
                </div>
                <div layout="row">
                    <md-input-container>
                        <label>Approximate amount you get</label>
                        <input name="getAmount" ng-model="card.getAmount" ng-disabled="true"
                               type="text"/>
                    </md-input-container>
                </div>
            </form>
            <div class="textCenter">
                <p>For making a payment from your card you will be redirected <br/> to the merchant's
                    website.</p>
            </div>
        </div>
    </div>

    <div class="flex-container">
        <wallet-box class="walletBox"
                    ng-repeat="w in walletList.wallets"
                    balance="w.balance"
                    on-send="walletList.send(w)"
                    on-withdraw="walletList.withdraw(w)"
                    on-deposit="walletList.deposit(w)"></wallet-box>
    </div>
    <waves-transaction-history heading="LATEST TRANSACTIONS"
                               transactions="walletList.transactions"
                               limit-to="10"></waves-transaction-history>
</div>